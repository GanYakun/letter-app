<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>è¯•å·æ¨¡æ¿ç”Ÿæˆå™¨</title>
  <script src="./vue.js"></script>
  <style>
    body {
      font-family: Arial;
      background: #f0f2f5;
      display: flex;
      justify-content: center;
      padding: 40px;
    }
    #app {
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      padding: 24px;
      width: 750px;
    }
    h2 {
      margin-bottom: 10px;
    }
    .category-tabs, .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }
    .category-tabs label, .tabs label {
      display: flex;
      align-items: center;
      background-color: #e0e0e0;
      border-radius: 6px;
      padding: 8px 16px;
      cursor: pointer;
    }
    .category-tabs input[type="checkbox"],
    .tabs input[type="checkbox"] {
      margin-right: 6px;
    }
    .tabs button {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      background-color: #e0e0e0;
      cursor: pointer;
    }
    .tabs button.active {
      background-color: #10a37f;
      color: white;
    }
    .checkboxes {
      margin-bottom: 16px;
    }
    .checkboxes label {
      margin-right: 16px;
      display: inline-block;
    }
    .checkboxes input[type="number"] {
      width: 60px;
      margin-left: 8px;
    }
    .chat {
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 16px;
      background: #fafafa;
      height: 120px;
      overflow-y: auto;
    }
    .input-area {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
    }
    .input-area input {
      flex: 1;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .input-area button {
      background: #10a37f;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .download-link {
      font-size: 14px;
    }
  </style>
</head>
<body>
<div id="app">
  <h2>ğŸ“˜ è¯•å·å‡ºé¢˜åŠ©æ‰‹</h2>

  <!-- åˆ†ç±»å¤šé€‰ -->
  <div class="category-tabs">
    <label><input type="checkbox" value="comprehensive" v-model="selectedCategories"> ç»¼åˆç±»</label>
    <label><input type="checkbox" value="professional" v-model="selectedCategories"> ä¸“ä¸šç±»</label>
  </div>

  <!-- å­ç±»å¤šé€‰ -->
  <div class="tabs">
    <template v-for="(subs, cat) in subCategories" v-if="selectedCategories.includes(cat)">
      <template v-for="sub in subs">
        <label><input type="checkbox" :value="sub" v-model="selectedSubs"> {{ sub }}</label>
      </template>
    </template>
  </div>

  <!-- é¢˜å‹é€‰æ‹© -->
  <div class="tabs">
    <button :class="{active: tab === 'objective'}" @click="tab = 'objective'">å®¢è§‚é¢˜</button>
    <button :class="{active: tab === 'subjective'}" @click="tab = 'subjective'">ä¸»è§‚é¢˜</button>
  </div>

  <div class="checkboxes">
    <template v-if="tab === 'objective'">
      <label v-for="type in objectiveTypes" :key="type">
        <input type="checkbox" :value="type" v-model="selectedTypes"> {{ type }}
        <input v-if="selectedTypes.includes(type)" type="number" v-model.number="questionCounts[type]" min="1" placeholder="æ•°é‡">
      </label>
    </template>
    <template v-else>
      <label v-for="type in subjectiveTypes" :key="type">
        <input type="checkbox" :value="type" v-model="selectedTypes"> {{ type }}
        <input v-if="selectedTypes.includes(type)" type="number" v-model.number="questionCounts[type]" min="1" placeholder="æ•°é‡">
      </label>
    </template>
  </div>

  <!-- èŠå¤©å¯¹è¯æ˜¾ç¤º -->
  <div class="chat">
    <div v-if="messages.length === 0">è¯·è¾“å…¥ä½ æƒ³è¦çš„è¯•å·è¯´æ˜ï¼Œä¾‹å¦‚â€œç”Ÿæˆä¸€ä»½çºªæ£€ç±»å•é€‰é¢˜è¯•å·â€</div>
    <div v-for="(msg, i) in messages" :key="i">ğŸ‘‰ {{ msg }}</div>
  </div>

  <!-- è¾“å…¥æ¡† -->
  <div class="input-area">
    <input v-model="userInput" placeholder="è¯·è¾“å…¥ä½ çš„å‡ºé¢˜è¦æ±‚..." @keyup.enter="handleGenerate">
    <button @click="handleGenerate">ç”Ÿæˆ</button>
  </div>

  <!-- ä¸‹è½½é“¾æ¥ -->
  <div class="download-link" v-if="docUrl">
    ğŸ“„ <a :href="docUrl" download="è¯•å·æ¨¡æ¿.doc">ç‚¹å‡»ä¸‹è½½ç”Ÿæˆçš„è¯•å·æ¨¡æ¿</a>
  </div>
</div>

<script>
new Vue({
  el: '#app',
  data: {
    selectedCategories: [],
    subCategories: {
      comprehensive: ['å…šå»º', 'çºªæ£€', 'è¡Œæµ‹'],
      professional: ['ä¸“ä¸šåŸºç¡€çŸ¥è¯†', 'ä¸“ä¸šç®¡ç†è¦æ±‚']
    },
    selectedSubs: [],
    tab: 'objective',
    selectedTypes: [],
    objectiveTypes: ['å•é€‰é¢˜', 'å¤šé€‰é¢˜', 'åˆ¤æ–­é¢˜'],
    subjectiveTypes: ['ç®€ç­”é¢˜', 'é—®ç­”é¢˜', 'è®ºè¿°é¢˜'],
    questionCounts: {},
    userInput: '',
    messages: [],
    docUrl: ''
  },
  methods: {
    handleGenerate() {
      if (!this.userInput.trim()) return;

      const categoryNames = this.selectedCategories.map(cat => cat === 'comprehensive' ? 'ç»¼åˆç±»' : 'ä¸“ä¸šç±»').join('ã€') || 'ï¼ˆæœªé€‰æ‹©åˆ†ç±»ï¼‰';
      const subs = this.selectedSubs.join('ã€') || 'ï¼ˆæœªé€‰æ‹©å­ç±»ï¼‰';
      const typeList = this.selectedTypes.map(t => `${t}ï¼ˆ${this.questionCounts[t] || 0}é¢˜ï¼‰`).join('ï¼Œ') || 'ï¼ˆæœªé€‰æ‹©é¢˜å‹ï¼‰';

      const fullMessage = `ä½ é€‰æ‹©äº†ã€${categoryNames}ã€‘ > ã€${subs}ã€‘ï¼Œé¢˜å‹ä¸ºï¼š${typeList}ã€‚\nè¯·æ±‚ï¼šâ€œ${this.userInput}â€`;
      this.messages.push(fullMessage);

      const wordContent = this.generateQuestions();
      this.generateWord(wordContent);
      this.userInput = '';
    },
    generateQuestions() {
      const catNames = this.selectedCategories.map(cat => cat === 'comprehensive' ? 'ç»¼åˆç±»' : 'ä¸“ä¸šç±»').join('ã€') || 'ï¼ˆæœªé€‰æ‹©åˆ†ç±»ï¼‰';
      const subs = this.selectedSubs.join('ã€') || 'ï¼ˆæœªé€‰æ‹©å­ç±»ï¼‰';
      let content = `ç±»åˆ«ï¼š${catNames} > ${subs}\né¢˜å‹ï¼š${this.selectedTypes.map(t => `${t}ï¼ˆ${this.questionCounts[t] || 0}é¢˜ï¼‰`).join('ï¼Œ')}\n\n`;

      this.selectedTypes.forEach((type) => {
        const count = this.questionCounts[type] || 3;
        content += `ã€${type}ã€‘\n`;
        for (let i = 1; i <= count; i++) {
          content += `${i}. è¯·ç¼–å†™ä¸€ä¸ª${type} ç¤ºä¾‹é¢˜ç›®ã€‚\n`;
        }
        content += '\n';
      });

      return content || 'æœªé€‰æ‹©ä»»ä½•é¢˜å‹';
    },
    generateWord(content) {
      const html = `
        <html><head><meta charset="utf-8"></head>
        <body>
          <h2>è¯•å·æ¨¡æ¿</h2>
          <pre>${content}</pre>
        </body></html>`;
      const blob = new Blob(['\ufeff' + html], {
        type: 'application/msword'
      });
      this.docUrl = URL.createObjectURL(blob);
    }
  }
});
</script>
</body>
</html>
